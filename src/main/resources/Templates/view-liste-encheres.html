<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Liste des enchères</title>
</head>
<body>

    <h1>Liste des enchères</h1>

    <!-- Formulaire de filtre -->
    <form th:action="@{/encheres}" method="get">
        <label for="nomArticle">Recherche :</label>
        <input type="text" id="nomArticle" name="nomArticle" 
               th:value="${nomRecherche}" placeholder="Nom de l'article" />

        <label for="categorie">Catégorie :</label>
        <select id="categorie" name="categorie">
            <option value="0" th:selected="${categorieRecherche == 0}">Toutes</option>
            <option th:each="cat : ${categories}" 
                    th:value="${cat.idCategorie}" 
                    th:text="${cat.libelle}"
                    th:selected="${cat.idCategorie == categorieRecherche}">
            </option>
        </select>

        <button type="submit">Rechercher</button>
    </form>

    <hr>

    <!-- Liste des articles -->
    <div th:if="${#lists.isEmpty(articles)}">
        <p>Aucune enchère en cours pour cette recherche.</p>
    </div>

    <div th:each="article : ${articles}">
        <h2>
            <a th:href="@{/article/{id}(id=${article.idArticle})}" 
               th:text="${article.nomArticle}">Nom article</a>
        </h2>
        <p th:text="${article.description}">Description</p>
        <p><strong>Catégorie :</strong> <span th:text="${article.categorie.libelle}">Informatique</span></p>
        <p><strong>Fin :</strong> 
            <span th:text="${#temporals.format(article.dateFinEncheres, 'dd/MM/yyyy')}">Date fin</span>
        </p>
        <p><strong>Mise à prix :</strong> <span th:text="${article.miseAPrix}">100</span> pts</p>
        <form th:action="@{/article/{id}(id=${article.idArticle})}" method="get">
       <button type="submit">Voir détail et enchérir</button>
       </form>
        
       <p><strong>Vendeur :</strong> 
    <a th:href="@{/utilisateur/profil(pseudo=${article.vendeur.pseudo})}" 
       th:text="${article.vendeur.pseudo}">
       pseudo
    </a>
</p>

        <hr>
    </div>

</body>
</html>
