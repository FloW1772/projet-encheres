<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Vendre Article</title>
</head>
<body>
<main>

    <h1 th:text="${modeModif} ? 'Modification de la Vente' : 'Nouvelle Vente'"></h1>

    <form  th:action="@{/vente/creation}" method="post" th:object="${articleAVendre}">

        <!-- ID caché (utile pour la modification) -->
        <input type="hidden" th:field="*{idArticle}" />

        <div id="bloc">
            <div id="bloc1">
                <!-- Nom de l’article -->
                <div id="tag">
                    <label for="inputNomArticle">Nom</label>
                    <input type="text" id="inputNomArticle" th:field="*{nomArticle}" required />
                    <ul th:if="${#fields.hasErrors('nomArticle')}" class="listErrors">
                        <li th:each="err : ${#fields.errors('nomArticle')}" th:text="${err}"></li>
                    </ul>
                </div>

                <!-- Catégorie -->
                <div>
                    <label for="selectCategorie">Catégorie</label>
                    <select th:field="*{categorie.idCategorie}" id="categorie" required>
                        <option value="">-- Sélectionner --</option>
                        <option th:each="categorie : ${categories}"
                                th:value="${categorie.idCategorie}"
                                th:text="${categorie.libelle}"></option>
                    </select>
                    <p class="error-message"
                       th:if="${#fields.hasErrors('categorie.idCategorie')}"
                       th:errors="*{categorie.idCategorie}"></p>
                </div>

                <!-- Description -->
                <div id="tag">
                    <label for="inputDescription">Description</label>
                    <textarea id="inputDescription" th:field="*{description}" required></textarea>
                    <ul th:if="${#fields.hasErrors('description')}" class="listErrors">
                        <li th:each="err : ${#fields.errors('description')}" th:text="${err}"></li>
                    </ul>
                </div>
            </div>

            <div id="bloc2">
                <!-- Mise à prix -->
                <div id="tag">
                    <label for="inputMiseAPrix">Mise à prix</label>
                    <input type="number" id="inputMiseAPrix" th:field="*{miseAPrix}" required />
                    <ul th:if="${#fields.hasErrors('miseAPrix')}" class="listErrors">
                        <li th:each="err : ${#fields.errors('miseAPrix')}" th:text="${err}"></li>
                    </ul>
                </div>

                <!-- Dates -->
                <div id="tag">
                    <label for="inputDateDebutEncheres">Début enchères</label>
                    <input type="datetime-local" id="inputDateDebutEncheres" th:field="*{dateDebutEncheres}" required />
                    <ul th:if="${#fields.hasErrors('dateDebutEncheres')}" class="listErrors">
                        <li th:each="err : ${#fields.errors('dateDebutEncheres')}" th:text="${err}"></li>
                    </ul>
                </div>

                <div id="tag">
                    <label for="inputDateFinEncheres">Fin enchères</label>
                    <input type="datetime-local" id="inputDateFinEncheres" th:field="*{dateFinEncheres}" required />
                    <ul th:if="${#fields.hasErrors('dateFinEncheres')}" class="listErrors">
                        <li th:each="err : ${#fields.errors('dateFinEncheres')}" th:text="${err}"></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Boutons -->
        <div id="set">
            <button type="submit">Valider</button>

            <!-- Affiché seulement en mode modification -->
            <a th:if="${modeModif}" th:href="@{'/vente/annuler'(id=*{id})}" class="btnPrimaire btnAnnuler">Annuler la vente</a>

            <a href="/" class="btn">Retour</a>
        </div>

        <!-- Erreur globale -->
        <ul th:if="${#fields.hasErrors('*')}" class="listErrors">
            <li th:text="#{Erreur inconnue}">Erreur inconnue</li>
        </ul>

    </form>

</main>
</body>
</html>